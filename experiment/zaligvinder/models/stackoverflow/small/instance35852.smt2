;test regex ^(A(?:ED|FN|LL|MD|NG|OA|RS|UD|WG|ZN)|B(?:AM|BD|DT|GN|HD|IF|MD|ND|OB|RL|SD|TN|WP|YR|ZD)|C(?:AD|DF|HF|LP|NY|OP|RC|UC|UP|VE|ZK)|D(?:JF|KK|OP|ZD)|E(?:GP|RN|TB|UR)|F(?:JD|KP)|G(?:BP|EL|HS|IP|MD|NF|TQ|YD)|H(?:KD|NL|RK|TG|UF)|I(?:DR|LS|NR|QD|RR|SK)|J(?:MD|OD|PY)|K(?:ES|GS|HR|MF|PW|RW|WD|YD|ZT)|L(?:AK|BP|KR|RD|SL|YD)|M(?:AD|DL|GA|KD|MK|NT|OP|RO|UR|VR|WK|XN|YR|ZN)|N(?:AD|GN|IO|OK|PR|ZD)|OMR|P(?:AB|EN|GK|HP|KR|LN|YG)|QAR|R(?:ON|SD|UB|WF)?|S(?:AR|BD|CR|DG|EK|GD|HP|LL|OS|RD|SP|TD|YP|ZL)|T(?:HB|JS|MT|ND|OP|RY|TD|WD|ZS)|U(?:AH|GX|SD|YU|ZS)|V(?:EF|ND|UV)|WST|X(?:AF|CD|OF|PF)|YER|Z(?:AR|MW))\s?([5-9][,\s][0-9]{3}[,\s]|[0-9]{2,3}[,\s][0-9]{3}[,\s]|[0-9]{1,3}[,\s](?:[0-9]{3}[,\s]){2,})([0-9]{3})\.([0-9]{2})$
(declare-const X String)
(assert (str.in_re X (re.++ (re.++ (str.to_re "") (re.++ (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "E") (str.to_re "D")) (re.++ (str.to_re "F") (str.to_re "N"))) (re.++ (str.to_re "L") (str.to_re "L"))) (re.++ (str.to_re "M") (str.to_re "D"))) (re.++ (str.to_re "N") (str.to_re "G"))) (re.++ (str.to_re "O") (str.to_re "A"))) (re.++ (str.to_re "R") (str.to_re "S"))) (re.++ (str.to_re "U") (str.to_re "D"))) (re.++ (str.to_re "W") (str.to_re "G"))) (re.++ (str.to_re "Z") (str.to_re "N")))) (re.++ (str.to_re "B") (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "M")) (re.++ (str.to_re "B") (str.to_re "D"))) (re.++ (str.to_re "D") (str.to_re "T"))) (re.++ (str.to_re "G") (str.to_re "N"))) (re.++ (str.to_re "H") (str.to_re "D"))) (re.++ (str.to_re "I") (str.to_re "F"))) (re.++ (str.to_re "M") (str.to_re "D"))) (re.++ (str.to_re "N") (str.to_re "D"))) (re.++ (str.to_re "O") (str.to_re "B"))) (re.++ (str.to_re "R") (str.to_re "L"))) (re.++ (str.to_re "S") (str.to_re "D"))) (re.++ (str.to_re "T") (str.to_re "N"))) (re.++ (str.to_re "W") (str.to_re "P"))) (re.++ (str.to_re "Y") (str.to_re "R"))) (re.++ (str.to_re "Z") (str.to_re "D"))))) (re.++ (str.to_re "C") (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "D")) (re.++ (str.to_re "D") (str.to_re "F"))) (re.++ (str.to_re "H") (str.to_re "F"))) (re.++ (str.to_re "L") (str.to_re "P"))) (re.++ (str.to_re "N") (str.to_re "Y"))) (re.++ (str.to_re "O") (str.to_re "P"))) (re.++ (str.to_re "R") (str.to_re "C"))) (re.++ (str.to_re "U") (str.to_re "C"))) (re.++ (str.to_re "U") (str.to_re "P"))) (re.++ (str.to_re "V") (str.to_re "E"))) (re.++ (str.to_re "Z") (str.to_re "K"))))) (re.++ (str.to_re "D") (re.union (re.union (re.union (re.++ (str.to_re "J") (str.to_re "F")) (re.++ (str.to_re "K") (str.to_re "K"))) (re.++ (str.to_re "O") (str.to_re "P"))) (re.++ (str.to_re "Z") (str.to_re "D"))))) (re.++ (str.to_re "E") (re.union (re.union (re.union (re.++ (str.to_re "G") (str.to_re "P")) (re.++ (str.to_re "R") (str.to_re "N"))) (re.++ (str.to_re "T") (str.to_re "B"))) (re.++ (str.to_re "U") (str.to_re "R"))))) (re.++ (str.to_re "F") (re.union (re.++ (str.to_re "J") (str.to_re "D")) (re.++ (str.to_re "K") (str.to_re "P"))))) (re.++ (str.to_re "G") (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "B") (str.to_re "P")) (re.++ (str.to_re "E") (str.to_re "L"))) (re.++ (str.to_re "H") (str.to_re "S"))) (re.++ (str.to_re "I") (str.to_re "P"))) (re.++ (str.to_re "M") (str.to_re "D"))) (re.++ (str.to_re "N") (str.to_re "F"))) (re.++ (str.to_re "T") (str.to_re "Q"))) (re.++ (str.to_re "Y") (str.to_re "D"))))) (re.++ (str.to_re "H") (re.union (re.union (re.union (re.union (re.++ (str.to_re "K") (str.to_re "D")) (re.++ (str.to_re "N") (str.to_re "L"))) (re.++ (str.to_re "R") (str.to_re "K"))) (re.++ (str.to_re "T") (str.to_re "G"))) (re.++ (str.to_re "U") (str.to_re "F"))))) (re.++ (str.to_re "I") (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "D") (str.to_re "R")) (re.++ (str.to_re "L") (str.to_re "S"))) (re.++ (str.to_re "N") (str.to_re "R"))) (re.++ (str.to_re "Q") (str.to_re "D"))) (re.++ (str.to_re "R") (str.to_re "R"))) (re.++ (str.to_re "S") (str.to_re "K"))))) (re.++ (str.to_re "J") (re.union (re.union (re.++ (str.to_re "M") (str.to_re "D")) (re.++ (str.to_re "O") (str.to_re "D"))) (re.++ (str.to_re "P") (str.to_re "Y"))))) (re.++ (str.to_re "K") (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "E") (str.to_re "S")) (re.++ (str.to_re "G") (str.to_re "S"))) (re.++ (str.to_re "H") (str.to_re "R"))) (re.++ (str.to_re "M") (str.to_re "F"))) (re.++ (str.to_re "P") (str.to_re "W"))) (re.++ (str.to_re "R") (str.to_re "W"))) (re.++ (str.to_re "W") (str.to_re "D"))) (re.++ (str.to_re "Y") (str.to_re "D"))) (re.++ (str.to_re "Z") (str.to_re "T"))))) (re.++ (str.to_re "L") (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "K")) (re.++ (str.to_re "B") (str.to_re "P"))) (re.++ (str.to_re "K") (str.to_re "R"))) (re.++ (str.to_re "R") (str.to_re "D"))) (re.++ (str.to_re "S") (str.to_re "L"))) (re.++ (str.to_re "Y") (str.to_re "D"))))) (re.++ (str.to_re "M") (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "D")) (re.++ (str.to_re "D") (str.to_re "L"))) (re.++ (str.to_re "G") (str.to_re "A"))) (re.++ (str.to_re "K") (str.to_re "D"))) (re.++ (str.to_re "M") (str.to_re "K"))) (re.++ (str.to_re "N") (str.to_re "T"))) (re.++ (str.to_re "O") (str.to_re "P"))) (re.++ (str.to_re "R") (str.to_re "O"))) (re.++ (str.to_re "U") (str.to_re "R"))) (re.++ (str.to_re "V") (str.to_re "R"))) (re.++ (str.to_re "W") (str.to_re "K"))) (re.++ (str.to_re "X") (str.to_re "N"))) (re.++ (str.to_re "Y") (str.to_re "R"))) (re.++ (str.to_re "Z") (str.to_re "N"))))) (re.++ (str.to_re "N") (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "D")) (re.++ (str.to_re "G") (str.to_re "N"))) (re.++ (str.to_re "I") (str.to_re "O"))) (re.++ (str.to_re "O") (str.to_re "K"))) (re.++ (str.to_re "P") (str.to_re "R"))) (re.++ (str.to_re "Z") (str.to_re "D"))))) (re.++ (str.to_re "O") (re.++ (str.to_re "M") (str.to_re "R")))) (re.++ (str.to_re "P") (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "B")) (re.++ (str.to_re "E") (str.to_re "N"))) (re.++ (str.to_re "G") (str.to_re "K"))) (re.++ (str.to_re "H") (str.to_re "P"))) (re.++ (str.to_re "K") (str.to_re "R"))) (re.++ (str.to_re "L") (str.to_re "N"))) (re.++ (str.to_re "Y") (str.to_re "G"))))) (re.++ (str.to_re "Q") (re.++ (str.to_re "A") (str.to_re "R")))) (re.++ (str.to_re "R") (re.opt (re.union (re.union (re.union (re.++ (str.to_re "O") (str.to_re "N")) (re.++ (str.to_re "S") (str.to_re "D"))) (re.++ (str.to_re "U") (str.to_re "B"))) (re.++ (str.to_re "W") (str.to_re "F")))))) (re.++ (str.to_re "S") (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "R")) (re.++ (str.to_re "B") (str.to_re "D"))) (re.++ (str.to_re "C") (str.to_re "R"))) (re.++ (str.to_re "D") (str.to_re "G"))) (re.++ (str.to_re "E") (str.to_re "K"))) (re.++ (str.to_re "G") (str.to_re "D"))) (re.++ (str.to_re "H") (str.to_re "P"))) (re.++ (str.to_re "L") (str.to_re "L"))) (re.++ (str.to_re "O") (str.to_re "S"))) (re.++ (str.to_re "R") (str.to_re "D"))) (re.++ (str.to_re "S") (str.to_re "P"))) (re.++ (str.to_re "T") (str.to_re "D"))) (re.++ (str.to_re "Y") (str.to_re "P"))) (re.++ (str.to_re "Z") (str.to_re "L"))))) (re.++ (str.to_re "T") (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.union (re.++ (str.to_re "H") (str.to_re "B")) (re.++ (str.to_re "J") (str.to_re "S"))) (re.++ (str.to_re "M") (str.to_re "T"))) (re.++ (str.to_re "N") (str.to_re "D"))) (re.++ (str.to_re "O") (str.to_re "P"))) (re.++ (str.to_re "R") (str.to_re "Y"))) (re.++ (str.to_re "T") (str.to_re "D"))) (re.++ (str.to_re "W") (str.to_re "D"))) (re.++ (str.to_re "Z") (str.to_re "S"))))) (re.++ (str.to_re "U") (re.union (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "H")) (re.++ (str.to_re "G") (str.to_re "X"))) (re.++ (str.to_re "S") (str.to_re "D"))) (re.++ (str.to_re "Y") (str.to_re "U"))) (re.++ (str.to_re "Z") (str.to_re "S"))))) (re.++ (str.to_re "V") (re.union (re.union (re.++ (str.to_re "E") (str.to_re "F")) (re.++ (str.to_re "N") (str.to_re "D"))) (re.++ (str.to_re "U") (str.to_re "V"))))) (re.++ (str.to_re "W") (re.++ (str.to_re "S") (str.to_re "T")))) (re.++ (str.to_re "X") (re.union (re.union (re.union (re.++ (str.to_re "A") (str.to_re "F")) (re.++ (str.to_re "C") (str.to_re "D"))) (re.++ (str.to_re "O") (str.to_re "F"))) (re.++ (str.to_re "P") (str.to_re "F"))))) (re.++ (str.to_re "Y") (re.++ (str.to_re "E") (str.to_re "R")))) (re.++ (str.to_re "Z") (re.union (re.++ (str.to_re "A") (str.to_re "R")) (re.++ (str.to_re "M") (str.to_re "W"))))) (re.++ (re.opt (re.union (str.to_re " ") (re.union (str.to_re "\u{0b}") (re.union (str.to_re "\u{0a}") (re.union (str.to_re "\u{0d}") (re.union (str.to_re "\u{09}") (str.to_re "\u{0c}"))))))) (re.++ (re.union (re.union (re.++ (re.range "5" "9") (re.++ (re.union (str.to_re ",") (re.union (str.to_re "\u{20}") (re.union (str.to_re "\u{0b}") (re.union (str.to_re "\u{0a}") (re.union (str.to_re "\u{0d}") (re.union (str.to_re "\u{09}") (str.to_re "\u{0c}"))))))) (re.++ ((_ re.loop 3 3) (re.range "0" "9")) (re.union (str.to_re ",") (re.union (str.to_re "\u{20}") (re.union (str.to_re "\u{0b}") (re.union (str.to_re "\u{0a}") (re.union (str.to_re "\u{0d}") (re.union (str.to_re "\u{09}") (str.to_re "\u{0c}")))))))))) (re.++ ((_ re.loop 2 3) (re.range "0" "9")) (re.++ (re.union (str.to_re ",") (re.union (str.to_re "\u{20}") (re.union (str.to_re "\u{0b}") (re.union (str.to_re "\u{0a}") (re.union (str.to_re "\u{0d}") (re.union (str.to_re "\u{09}") (str.to_re "\u{0c}"))))))) (re.++ ((_ re.loop 3 3) (re.range "0" "9")) (re.union (str.to_re ",") (re.union (str.to_re "\u{20}") (re.union (str.to_re "\u{0b}") (re.union (str.to_re "\u{0a}") (re.union (str.to_re "\u{0d}") (re.union (str.to_re "\u{09}") (str.to_re "\u{0c}"))))))))))) (re.++ ((_ re.loop 1 3) (re.range "0" "9")) (re.++ (re.union (str.to_re ",") (re.union (str.to_re "\u{20}") (re.union (str.to_re "\u{0b}") (re.union (str.to_re "\u{0a}") (re.union (str.to_re "\u{0d}") (re.union (str.to_re "\u{09}") (str.to_re "\u{0c}"))))))) (re.++ (re.* (re.++ ((_ re.loop 3 3) (re.range "0" "9")) (re.union (str.to_re ",") (re.union (str.to_re "\u{20}") (re.union (str.to_re "\u{0b}") (re.union (str.to_re "\u{0a}") (re.union (str.to_re "\u{0d}") (re.union (str.to_re "\u{09}") (str.to_re "\u{0c}"))))))))) ((_ re.loop 2 2) (re.++ ((_ re.loop 3 3) (re.range "0" "9")) (re.union (str.to_re ",") (re.union (str.to_re "\u{20}") (re.union (str.to_re "\u{0b}") (re.union (str.to_re "\u{0a}") (re.union (str.to_re "\u{0d}") (re.union (str.to_re "\u{09}") (str.to_re "\u{0c}"))))))))))))) (re.++ ((_ re.loop 3 3) (re.range "0" "9")) (re.++ (str.to_re ".") ((_ re.loop 2 2) (re.range "0" "9")))))))) (str.to_re ""))))
; sanitize danger characters:  < > ' " \ / &
(assert (not (str.in_re X (re.* (re.union (str.to_re "\u{3c}") (str.to_re "\u{3e}") (str.to_re "\u{27}") (str.to_re "\u{22}") (str.to_re "\u{5c}") (str.to_re "\u{2f}") (str.to_re "\u{26}"))))))
(assert (< 20 (str.len X)))
(check-sat)
(get-model)